

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>pdbeccdutils &mdash; PDBe API webinar series 1.0 documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/jupyter-sphinx.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/thebelab.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/styles.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
        <script src="../../_static/thebelab-helper.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="arpeggio" href="arpeggio.html" />
    <link rel="prev" title="pdbecif" href="pdbecif.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home" alt="Documentation Home"> PDBe API webinar series
          

          
            
            <img src="../../_static/pdbelogo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../web1/webinar.html">Introduction to PDBe programmatic access</a></li>
<li class="toctree-l1"><a class="reference internal" href="../web2/webinar.html">Searching with the PDBe API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../web2/6_PDB_search.html">PDB search</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../web2/6_PDB_search.html#1)-Making-imports-and-setting-variables">1) Making imports and setting variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="../web2/6_PDB_search.html#2)-a-function-to-get-data-from-the-search-API">2) a function to get data from the search API</a></li>
<li class="toctree-l3"><a class="reference internal" href="../web2/6_PDB_search.html#3)-formatting-the-search-terms">3) formatting the search terms</a></li>
<li class="toctree-l3"><a class="reference internal" href="../web2/6_PDB_search.html#4)-Getting-useful-data-out-of-the-search">4) Getting useful data out of the search</a></li>
<li class="toctree-l3"><a class="reference internal" href="../web2/6_PDB_search.html#5)-running-a-search">5) running a search</a></li>
<li class="toctree-l3"><a class="reference internal" href="../web2/6_PDB_search.html#6)-Analysing-and-plotting-the-results">6) Analysing and plotting the results</a></li>
<li class="toctree-l3"><a class="reference internal" href="../web2/6_PDB_search.html#7)-searching-for-two-terms-at-once">7) searching for two terms at once</a></li>
<li class="toctree-l3"><a class="reference internal" href="../web2/6_PDB_search.html#Questions-to-answer">Questions to answer</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../web2/7_PDB_sequence_search.html">PDB sequence search</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../web2/7_PDB_sequence_search.html#1)-Making-imports-and-setting-variables">1) Making imports and setting variables</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../web3/webinar.html">Creating complex PDBe API queries</a></li>
<li class="toctree-l1"><a class="reference internal" href="../web4/webinar.html">Using the PDBe Graph API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../web4/webinar.html#introduction">Introduction</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../web4/webinar.html#using-the-documentation">Using the documentation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../web4/webinar.html#usecases">Usecases</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../web4/usecases/ligand_sites.html">Predicted ligand binding sites in interaction interface</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../web4/usecases/ligand_sites.html#1)-Get-the-annotations-data-for-UniProt-accession-P61626">1) Get the annotations data for UniProt accession <code class="docutils literal notranslate"><span class="pre">P61626</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../web4/usecases/ligand_sites.html#2)-Filter-the-data-for-providers-p2rank-and-3dligandsite">2) Filter the data for providers <code class="docutils literal notranslate"><span class="pre">p2rank</span></code> and <code class="docutils literal notranslate"><span class="pre">3dligandsite</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../web4/usecases/ligand_sites.html#3)-Get-interacting-residues-for-the-UniProt-accession">3) Get interacting residues for the UniProt accession</a></li>
<li class="toctree-l4"><a class="reference internal" href="../web4/usecases/ligand_sites.html#4)-Filter-interface_data-on-common-residues">4) Filter <code class="docutils literal notranslate"><span class="pre">interface_data</span></code> on common residues</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../web4/usecases/accessible_residues.html">Accessible residues for a PDB structure</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../web4/usecases/accessible_residues.html#1)-Get-the-3Dcomplex-annotations-for-PDB-entry-3pxe">1) Get the <code class="docutils literal notranslate"><span class="pre">3Dcomplex</span></code> annotations for PDB entry <code class="docutils literal notranslate"><span class="pre">3pxe</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../web4/usecases/accessible_residues.html#2)-Filter-the-data-for-ASA_alone-label">2) Filter the data for <code class="docutils literal notranslate"><span class="pre">ASA_alone</span></code> label</a></li>
<li class="toctree-l4"><a class="reference internal" href="../web4/usecases/accessible_residues.html#3)-Filter-site_residues-on-raw_score-&gt;-0">3) Filter <code class="docutils literal notranslate"><span class="pre">site_residues</span></code> on <code class="docutils literal notranslate"><span class="pre">raw_score</span> <span class="pre">&gt;</span> <span class="pre">0</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="webinar.html">PDBe tools in GitHub</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="pdbecif.html">pdbecif</a><ul>
<li class="toctree-l3"><a class="reference internal" href="pdbecif.html#Structure-reading">Structure reading</a><ul>
<li class="toctree-l4"><a class="reference internal" href="pdbecif.html#Dictionary-output">Dictionary output</a></li>
<li class="toctree-l4"><a class="reference internal" href="pdbecif.html#CIFWrapper-output">CIFWrapper output</a></li>
<li class="toctree-l4"><a class="reference internal" href="pdbecif.html#CifFile-output">CifFile output</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pdbecif.html#Structure-writing">Structure writing</a></li>
</ul>
</li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">pdbeccdutils</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Structure-reading">Structure reading</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Component-object">Component object</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Scaffolds">Scaffolds</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Fragments">Fragments</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Molecular-depictions">Molecular depictions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Structure-writing">Structure writing</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Parity-method">Parity method</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Scripts">Scripts</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="arpeggio.html">arpeggio</a><ul>
<li class="toctree-l3"><a class="reference internal" href="arpeggio.html#Precomputed-data">Precomputed data</a></li>
<li class="toctree-l3"><a class="reference internal" href="arpeggio.html#Example">Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="arpeggio.html#arpeggio-script">arpeggio script</a></li>
<li class="toctree-l3"><a class="reference internal" href="arpeggio.html#arpeggio-API">arpeggio API</a></li>
<li class="toctree-l3"><a class="reference internal" href="arpeggio.html#Excercise">Excercise</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../web6/webinar.html">Data visualisation at PDBe</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">PDBe API webinar series</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="webinar.html">PDBe tools in GitHub</a> &raquo;</li>
        
      <li>pdbeccdutils</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/webinars/web5/pdbeccdutils.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container,
div.nbinput.container div.prompt,
div.nbinput.container div.input_area,
div.nbinput.container div[class*=highlight],
div.nbinput.container div[class*=highlight] pre,
div.nboutput.container,
div.nboutput.container div.prompt,
div.nboutput.container div.output_area,
div.nboutput.container div[class*=highlight],
div.nboutput.container div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="pdbeccdutils">
<h1>pdbeccdutils<a class="headerlink" href="#pdbeccdutils" title="Permalink to this headline">¶</a></h1>
<p>This exercise demonstrates the use of the <a class="reference external" href="https://github.com/PDBeurope/ccdutils">pdbeccdutils</a> - a set of python tools for working with small molecule components in the Protein Data Bank archive.</p>
<p>You can use two main resources as input data for the package. <a class="reference external" href="http://www.wwpdb.org/data/ccd">wwPDB CCD</a> contains models of all the ligands e.g. drug molecules, cofactors etc. commonly found in the PDB archive, whereas <a class="reference external" href="http://www.wwpdb.org/data/bird">wwPDB BIRD</a> is composed of biologically interesting polymeric molecules such as peptides or oligosaccharides.</p>
<p>CCD components can be downloaded as a bundle either from <a class="reference external" href="ftp://ftp.wwpdb.org/pub/pdb/data/monomers/components.cif.gz">wwPDB FTP area</a>, or from <a class="reference external" href="http://ftp.ebi.ac.uk/pub/databases/msd/pdbechem_v2/components.cif">PDBe FTP area</a>. The components from the PDBe area are enriched with information about common fragments found in the molecules, their molecular scaffolds as well as links to popular small molecule chemistry databases. You can also use PDBeChem to download individual components from
the following link using proper CCD id substitution: <a class="reference external" href="ftp://ftp.ebi.ac.uk/pub/databases/msd/pdbechem_v2/H/HEM/HEM.cif">ftp://ftp.ebi.ac.uk/pub/databases/msd/pdbechem_v2/H/HEM/HEM.cif</a>.</p>
<p>‘BIRD’ molecules can be downloaded in the *.tar.gz format from the following location: <a class="reference external" href="ftp://ftp.wwpdb.org/pub/pdb/data/bird/prd/prdcc-split.tar.gz">ftp://ftp.wwpdb.org/pub/pdb/data/bird/prd/prdcc-split.tar.gz</a></p>
<p>pdbeccdutils relies on <a class="reference external" href="https://www.rdkit.org/">RDKit</a> for the most of its functionality and as such it is best to be used along with <a class="reference external" href="https://docs.conda.io/projects/conda/en/latest/user-guide/tasks/manage-environments.html">conda environment</a></p>
<p>Install and activate conda environment with rdkit using the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>conda create -c conda-forge -n rdkit-env rdkit <span class="nv">python</span><span class="o">=</span><span class="m">3</span>.7
conda activate rdkit-env
</pre></div>
</div>
<p>You can then install the pdbeccdutils either from <a class="reference external" href="https://pypi.org/project/pdbeccdutils/">PYPi</a> or directly from the <a class="reference external" href="https://github.com/PDBeurope/ccdutils">repository</a> using one of the following commands:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip install pdbeccdutils
pip install git+https://github.com/PDBeurope/ccdutils.git@master#egg<span class="o">=</span>pdbeccdutils
</pre></div>
</div>
<p>The pdbeccdutils API contains a number of different modules stored in namespaces with respect to their functionality. All off the modules along with useful tips are documented in the <a class="reference external" href="https://pdbeurope.github.io/ccdutils/">documentation</a>. In this exercise we will go through some of the use cases.</p>
<p>The structure of the package looks roughly like this:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>pdbeccdutils
  computations
    parity_method.py
  core
    ccd_reader.py
    ccd_writer.py
    component.py
    depictions.py
    fragment_library.py
  scripts
    process_components_cif_cli.py
    setup_pubchem_library.py
  utils
    pubchem_downloader.py
    web_services.py
</pre></div>
</div>
<p>Before we start we need to download a CCD component for demonstaration purposes. We are going to use Heme (CCD ID: <a class="reference external" href="https://www.ebi.ac.uk/pdbe-srv/pdbechem/chemicalCompound/show/HEM">HEM</a>).</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">requests</span>

<span class="k">def</span> <span class="nf">download_component</span><span class="p">(</span><span class="n">ccd_id</span><span class="p">):</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;http://ftp.ebi.ac.uk/pub/databases/msd/pdbechem_v2/</span><span class="si">{</span><span class="n">ccd_id</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">ccd_id</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">ccd_id</span><span class="si">}</span><span class="s1">.cif&#39;</span><span class="p">)</span>
    <span class="n">cif_path</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">ccd_id</span><span class="si">}</span><span class="s1">.cif&#39;</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">cif_path</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
        <span class="n">fp</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">cif_path</span>

<span class="n">hem_path</span> <span class="o">=</span> <span class="n">download_component</span><span class="p">(</span><span class="s1">&#39;HEM&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="Structure-reading">
<h2>Structure reading<a class="headerlink" href="#Structure-reading" title="Permalink to this headline">¶</a></h2>
<p>Structure reading can be done using <code class="docutils literal notranslate"><span class="pre">ccd_reader.py</span></code> module located in the <code class="docutils literal notranslate"><span class="pre">pdbeccdutils.core</span></code> module. By default, the molecules comes <a class="reference external" href="https://www.rdkit.org/docs/RDKit_Book.html#molecular-sanitization">sanitized</a> using RDKit sanitization procedure and our internal process. However, this option can be turned off by specifying optional parameter <code class="docutils literal notranslate"><span class="pre">sanitize=False</span></code> to the function.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">pdbeccdutils.core</span> <span class="kn">import</span> <span class="n">ccd_reader</span>

<span class="n">ccd_reader_result</span> <span class="o">=</span> <span class="n">ccd_reader</span><span class="o">.</span><span class="n">read_pdb_cif_file</span><span class="p">(</span><span class="n">hem_path</span><span class="p">)</span>
<span class="n">ccd_reader_result</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
CCDReaderResult(warnings=[], errors=[], component=&lt;pdbeccdutils.core.component.Component object at 0x7f86f7154710&gt;)
</pre></div></div>
</div>
<p>CCDReaderResult contains a list of possible warnings and errors that were encountered during the structure parsing. There is also a convenience method that allows reading in multiple chemical components provided they are listed in different data blocks in a single mmCIF file at the same time.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">components_result</span> <span class="o">=</span> <span class="n">ccd_reader</span><span class="o">.</span><span class="n">read_pdb_components_file</span><span class="p">(</span><span class="s1">&#39;HEM.cif&#39;</span><span class="p">,</span> <span class="n">sanitize</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">components_result</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;HEM&#39;: CCDReaderResult(warnings=[], errors=[], component=&lt;pdbeccdutils.core.component.Component object at 0x7f86f6804050&gt;)}
</pre></div></div>
</div>
</div>
<div class="section" id="Component-object">
<h2>Component object<a class="headerlink" href="#Component-object" title="Permalink to this headline">¶</a></h2>
<p>The component object contains a list of usefull properties retrieved directly from the CCD file as well as shorthand functions to the RDKit functionality in the following excercise we will go through some of them.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">component</span> <span class="o">=</span> <span class="n">ccd_reader_result</span><span class="o">.</span><span class="n">component</span>
<span class="n">component</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;pdbeccdutils.core.component.Component at 0x7f86f7154710&gt;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">component</span><span class="o">.</span><span class="n">formula</span>

</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&#39;C34 H32 Fe N4 O4&#39;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">component</span><span class="o">.</span><span class="n">inchikey</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&#39;KABFMIBPWCXCRK-RGGAHWMASA-L&#39;
</pre></div></div>
</div>
<div class="section" id="Scaffolds">
<h3>Scaffolds<a class="headerlink" href="#Scaffolds" title="Permalink to this headline">¶</a></h3>
<p>One of the shorthand function allows you to calculate molecular scaffolds using <a class="reference external" href="https://pdbeurope.github.io/ccdutils/pdbeccdutils.core.html#pdbeccdutils.core.component.Component.get_scaffolds">get_scaffolds()</a> method. You can choose a number of different scaffolds to compute, if you don’t provide any parameter <a class="reference external" href="https://www.rdkit.org/docs/source/rdkit.Chem.Scaffolds.MurckoScaffold.html">Murcko scaffold</a> is computed by default.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># at first scaffolds property is empty</span>
<span class="n">component</span><span class="o">.</span><span class="n">scaffolds</span>
<span class="p">[]</span>

<span class="c1"># returns an array of rdkit Mol objects with scaffolds found.</span>
<span class="n">component</span><span class="o">.</span><span class="n">get_scaffolds</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&lt;rdkit.Chem.rdchem.Mol at 0x7f86f7cb9ad0&gt;]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">scaffold_details</span> <span class="o">=</span> <span class="n">component</span><span class="o">.</span><span class="n">scaffolds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">scaffold_details</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
SubstructureMapping(name=&#39;MurckoScaffold&#39;, smiles=&#39;C1=CC2=[N+]3C1=Cc1ccc4n1[Fe-2]31n3c(ccc3=CC3=[N+]1C(=C4)C=C3)=C2&#39;, source=&#39;RDKit scaffolds&#39;, mappings=[[&#39;CHA&#39;, &#39;CHB&#39;, &#39;CHC&#39;, &#39;CHD&#39;, &#39;C1A&#39;, &#39;C2A&#39;, &#39;C3A&#39;, &#39;C4A&#39;, &#39;C1B&#39;, &#39;C2B&#39;, &#39;C3B&#39;, &#39;C4B&#39;, &#39;C1C&#39;, &#39;C2C&#39;, &#39;C3C&#39;, &#39;C4C&#39;, &#39;C1D&#39;, &#39;C2D&#39;, &#39;C3D&#39;, &#39;C4D&#39;, &#39;NA&#39;, &#39;NB&#39;, &#39;NC&#39;, &#39;ND&#39;, &#39;FE&#39;]])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># list of lists of atom names with atoms that are part of the scaffold.</span>
<span class="n">scaffold_details</span><span class="o">.</span><span class="n">mappings</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[&#39;CHA&#39;,
  &#39;CHB&#39;,
  &#39;CHC&#39;,
  &#39;CHD&#39;,
  &#39;C1A&#39;,
  &#39;C2A&#39;,
  &#39;C3A&#39;,
  &#39;C4A&#39;,
  &#39;C1B&#39;,
  &#39;C2B&#39;,
  &#39;C3B&#39;,
  &#39;C4B&#39;,
  &#39;C1C&#39;,
  &#39;C2C&#39;,
  &#39;C3C&#39;,
  &#39;C4C&#39;,
  &#39;C1D&#39;,
  &#39;C2D&#39;,
  &#39;C3D&#39;,
  &#39;C4D&#39;,
  &#39;NA&#39;,
  &#39;NB&#39;,
  &#39;NC&#39;,
  &#39;ND&#39;,
  &#39;FE&#39;]]
</pre></div></div>
</div>
</div>
<div class="section" id="Fragments">
<h3>Fragments<a class="headerlink" href="#Fragments" title="Permalink to this headline">¶</a></h3>
<p>pdbeccdutils package contains also a shorthand functions to enable searching through fragment libraries. By default the code is supplied with a hand-curated library that is internally used by the PDBe as well as collaborating resources ENAMINE and DSI. You can read more about the molecular fragments the built-in library contains in the <a class="reference external" href="https://pdbeurope.github.io/ccdutils/guide/fragments.html">documentation</a> as well as about an input file format in case you want to supply your own fragment
library.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">pdbeccdutils.core.fragment_library</span> <span class="kn">import</span> <span class="n">FragmentLibrary</span>

<span class="c1"># if you dont provide any parameter to the FragmentLibrary constructor</span>
<span class="c1"># supplied fragment library is used</span>
<span class="n">library</span> <span class="o">=</span> <span class="n">FragmentLibrary</span><span class="p">()</span>
<span class="n">fragments</span> <span class="o">=</span> <span class="n">component</span><span class="o">.</span><span class="n">library_search</span><span class="p">(</span><span class="n">library</span><span class="p">)</span>
<span class="nb">len</span><span class="p">(</span><span class="n">fragments</span><span class="p">)</span>

</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fragments</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
SubstructureMapping(name=&#39;pyrrole&#39;, smiles=&#39;c1cc[nH]c1&#39;, source=&#39;PDBe&#39;, mappings=((4, 5, 6, 7, 38), (21, 22, 23, 24, 40)))
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">component</span><span class="o">.</span><span class="n">fragments</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">mappings</span><span class="p">)</span><span class="si">}</span><span class="s1"> instance(s) of the fragment </span><span class="si">{</span><span class="n">f</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1"> found. SMILES:</span><span class="si">{</span><span class="n">f</span><span class="o">.</span><span class="n">smiles</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1 instance(s) of the fragment porphin-like found. SMILES:C1~C~C2~C~C3~C~C~C(~C~C4~C~C~C(~C~C5~C~C~C(~C~C~1~N~2)~N~5)~N~4)~N~3
2 instance(s) of the fragment pyrrole found. SMILES:c1cc[nH]c1
</pre></div></div>
</div>
</div>
<div class="section" id="Molecular-depictions">
<h3>Molecular depictions<a class="headerlink" href="#Molecular-depictions" title="Permalink to this headline">¶</a></h3>
<p>component object exposes method <a class="reference external" href="https://pdbeurope.github.io/ccdutils/pdbeccdutils.core.html#pdbeccdutils.core.component.Component.compute_2d">compute_2d()</a> that takes <a class="reference external" href="https://pdbeurope.github.io/ccdutils/pdbeccdutils.core.html#pdbeccdutils.core.depictions.DepictionManager">DepictionManager</a> object as an argument. This enables you to take advantage of depiction templates supplied with the package. Alternativelly, you can provide paths to your own depiction templates and templates from
PubChem. You build a library of pubchem templates using the following <a class="reference external" href="https://pdbeurope.github.io/ccdutils/pdbeccdutils.scripts.html#module-pdbeccdutils.scripts.setup_pubchem_library_cli">script</a>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">rdkit.Chem.Draw</span> <span class="kn">import</span> <span class="n">IPythonConsole</span> <span class="c1"># this import allows you to display images directly in the jupyter notebook</span>
<span class="kn">from</span> <span class="nn">IPython.core.display</span> <span class="kn">import</span> <span class="n">SVG</span> <span class="c1"># allows to display SVG images</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">pdbeccdutils.core.depictions</span> <span class="kn">import</span> <span class="n">DepictionManager</span>

<span class="c1"># create an instance of the depiction manager</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">DepictionManager</span><span class="p">()</span>
<span class="n">result_2d</span> <span class="o">=</span> <span class="n">component</span><span class="o">.</span><span class="n">compute_2d</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="n">result_2d</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
DepictionResult(source=&lt;DepictionSource.Template: 2&gt;, template_name=&#39;hem&#39;, mol=&lt;rdkit.Chem.rdchem.RWMol object at 0x7f86f81bd330&gt;, score=0.0)
</pre></div></div>
</div>
<p>We can use the score that is part of the result to find out the quality of the depiction. Generally, the lower the better. Higher values indicate bonds crossings and crowded atoms.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># depiction score</span>
<span class="n">result_2d</span><span class="o">.</span><span class="n">score</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.0
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># and the depiction itself</span>
<span class="n">result_2d</span><span class="o">.</span><span class="n">mol</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../../_images/webinars_web5_pdbeccdutils_28_0.png" src="../../_images/webinars_web5_pdbeccdutils_28_0.png" />
</div>
</div>
<p>Let’s have a look at the example where molecular depiction cannot be drawn as collision free. We are going to use <a class="reference external" href="https://www.ebi.ac.uk/pdbe-srv/pdbechem/chemicalCompound/show/ADO">Adamantone</a> as an example.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ado_path</span> <span class="o">=</span> <span class="n">download_component</span><span class="p">(</span><span class="s1">&#39;ADO&#39;</span><span class="p">)</span>
<span class="n">ado</span> <span class="o">=</span> <span class="n">ccd_reader</span><span class="o">.</span><span class="n">read_pdb_cif_file</span><span class="p">(</span><span class="n">ado_path</span><span class="p">)</span><span class="o">.</span><span class="n">component</span>
<span class="n">ado_depiction_result</span> <span class="o">=</span> <span class="n">ado</span><span class="o">.</span><span class="n">compute_2d</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Depiction score is: </span><span class="si">{</span><span class="n">ado_depiction_result</span><span class="o">.</span><span class="n">score</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">ado_depiction_result</span><span class="o">.</span><span class="n">mol</span>

</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Depiction score is: 1.0
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../../_images/webinars_web5_pdbeccdutils_30_1.png" src="../../_images/webinars_web5_pdbeccdutils_30_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># we can also use convenient functions to store the depiction as an svg image:</span>
<span class="n">component</span><span class="o">.</span><span class="n">export_2d_svg</span><span class="p">(</span><span class="s1">&#39;HEM.svg&#39;</span><span class="p">)</span>

<span class="c1"># including atom names</span>
<span class="n">component</span><span class="o">.</span><span class="n">export_2d_svg</span><span class="p">(</span><span class="s1">&#39;HEM_with_names.svg&#39;</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">SVG</span><span class="p">(</span><span class="s1">&#39;HEM_with_names.svg&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../../_images/webinars_web5_pdbeccdutils_31_0.svg" src="../../_images/webinars_web5_pdbeccdutils_31_0.svg" /></div>
</div>
<p>We can also export the svg image and highlight atoms and bonds. Let’s highlight the molecular scaffold we calculated earlier.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># retrieve list of atom names that are part of the scaffold</span>
<span class="c1"># and color them in green. RGB: (0.2, 0.5, 0.2).</span>
<span class="c1"># Scale 0-1 is used instead of the common 0-255</span>
<span class="n">scaffold</span> <span class="o">=</span> <span class="n">component</span><span class="o">.</span><span class="n">scaffolds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">atom_names</span> <span class="o">=</span> <span class="n">scaffold</span><span class="o">.</span><span class="n">mappings</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">atom_color_mapping</span> <span class="o">=</span> <span class="p">{</span><span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">atom_names</span><span class="p">}</span>

<span class="c1"># find out all the bonds that are formed among the scaffold atoms and color them in green as well.</span>
<span class="n">bond_color_highlight</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">bonds</span> <span class="o">=</span> <span class="n">component</span><span class="o">.</span><span class="n">mol_no_h</span><span class="o">.</span><span class="n">GetBonds</span><span class="p">()</span>
<span class="k">for</span> <span class="n">bond</span> <span class="ow">in</span> <span class="n">bonds</span><span class="p">:</span>
    <span class="n">begin</span> <span class="o">=</span> <span class="n">bond</span><span class="o">.</span><span class="n">GetBeginAtom</span><span class="p">()</span><span class="o">.</span><span class="n">GetProp</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">)</span>
    <span class="n">end</span> <span class="o">=</span> <span class="n">bond</span><span class="o">.</span><span class="n">GetEndAtom</span><span class="p">()</span><span class="o">.</span><span class="n">GetProp</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">begin</span> <span class="ow">in</span> <span class="n">atom_names</span> <span class="ow">and</span> <span class="n">end</span> <span class="ow">in</span> <span class="n">atom_names</span><span class="p">:</span>
        <span class="n">bond_color_highlight</span><span class="p">[(</span><span class="n">begin</span><span class="p">,</span> <span class="n">end</span><span class="p">)]</span> <span class="o">=</span> <span class="p">((</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">))</span>

<span class="c1"># draw the final image</span>
<span class="n">component</span><span class="o">.</span><span class="n">export_2d_svg</span><span class="p">(</span><span class="s1">&#39;HEM_with_scaffold.svg&#39;</span><span class="p">,</span>
                        <span class="n">atom_highlight</span><span class="o">=</span><span class="n">atom_color_mapping</span><span class="p">,</span>
                        <span class="n">bond_highlight</span><span class="o">=</span><span class="n">bond_color_highlight</span><span class="p">)</span>
<span class="n">SVG</span><span class="p">(</span><span class="s1">&#39;HEM_with_scaffold.svg&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../../_images/webinars_web5_pdbeccdutils_33_0.svg" src="../../_images/webinars_web5_pdbeccdutils_33_0.svg" /></div>
</div>
<p>The exactly same operations can be done by using input data from wwPDB BIRD dictionary. For the following example we are going to use <a class="reference external" href="https://en.wikipedia.org/wiki/Vancomycin">Vancomycin</a>, an antibiotic used for bacterial infection treatment. Just download <code class="docutils literal notranslate"><span class="pre">PRDCC_000204</span></code> wwPDB BIRD entry from the <a class="reference external" href="ftp://ftp.wwpdb.org/pub/pdb/data/bird/prd/">FTP directory</a>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">c</span> <span class="o">=</span> <span class="n">ccd_reader</span><span class="o">.</span><span class="n">read_pdb_cif_file</span><span class="p">(</span><span class="s1">&#39;PRDCC_000204.cif&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">component</span>
<span class="n">c</span><span class="o">.</span><span class="n">compute_2d</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">mol</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../../_images/webinars_web5_pdbeccdutils_35_0.png" src="../../_images/webinars_web5_pdbeccdutils_35_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="Structure-writing">
<h2>Structure writing<a class="headerlink" href="#Structure-writing" title="Permalink to this headline">¶</a></h2>
<p>Structure writing can be done using <code class="docutils literal notranslate"><span class="pre">ccd_writer.py</span></code> module located in the <code class="docutils literal notranslate"><span class="pre">pdbeccdutils.core</span></code> module. This module exposes <a class="reference external" href="https://pdbeurope.github.io/ccdutils/pdbeccdutils.core.html#pdbeccdutils.core.ccd_writer.write_molecule">write_molecule()</a> method that enables writing out conformers of chemical components in a number of different formats. See example below:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">pdbeccdutils.core</span> <span class="kn">import</span> <span class="n">ccd_writer</span>
<span class="kn">from</span> <span class="nn">pdbeccdutils.core.models</span> <span class="kn">import</span> <span class="n">ConformerType</span>

<span class="c1"># write out ideal conformer in the PDB format</span>
<span class="n">ccd_writer</span><span class="o">.</span><span class="n">write_molecule</span><span class="p">(</span><span class="s1">&#39;HEM_ideal.pdb&#39;</span><span class="p">,</span> <span class="n">component</span><span class="p">,</span> <span class="n">conf_type</span><span class="o">=</span><span class="n">ConformerType</span><span class="o">.</span><span class="n">Ideal</span><span class="p">)</span>

<span class="c1"># write out model conformer in the SDF format without hydrogens</span>
<span class="n">ccd_writer</span><span class="o">.</span><span class="n">write_molecule</span><span class="p">(</span><span class="s1">&#39;HEM_model_no_h.sdf&#39;</span><span class="p">,</span>
                          <span class="n">component</span><span class="p">,</span> <span class="n">remove_hs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">conf_type</span><span class="o">=</span><span class="n">ConformerType</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span>

<span class="c1"># write out metadata information in CML format</span>
<span class="n">ccd_writer</span><span class="o">.</span><span class="n">write_molecule</span><span class="p">(</span><span class="s1">&#39;HEM_in_cif.cml&#39;</span><span class="p">,</span> <span class="n">component</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Parity-method">
<h2>Parity method<a class="headerlink" href="#Parity-method" title="Permalink to this headline">¶</a></h2>
<p>There is a number of chemical similarity methods that can estimate a degree of similarity between the two molecules. pdbeccdutils implements one of such methods that takes advantage of maximum common sub-structures. This method is called PARITY and was developed by Jon Tyzack while working at EBI. You can read the description of the method in the <a class="reference external" href="https://doi.org/10.1016/j.str.2018.02.009">published paper</a>.</p>
<p>In the following example we are going to examine molecular similarity of two heme variants <a class="reference external" href="http://pdbe.org/chem/HEA">HEME A</a> and <a class="reference external" href="http://pdbe.org/chem/DHE">HEME D</a></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># download the structures first</span>
<span class="n">hem_a_path</span> <span class="o">=</span> <span class="n">download_component</span><span class="p">(</span><span class="s1">&#39;HEA&#39;</span><span class="p">)</span>
<span class="n">hem_d_path</span> <span class="o">=</span> <span class="n">download_component</span><span class="p">(</span><span class="s1">&#39;DHE&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">pdbeccdutils.computations.parity_method</span> <span class="kn">import</span> <span class="n">compare_molecules</span>

<span class="n">hem_a</span> <span class="o">=</span> <span class="n">ccd_reader</span><span class="o">.</span><span class="n">read_pdb_cif_file</span><span class="p">(</span><span class="n">hem_a_path</span><span class="p">)</span><span class="o">.</span><span class="n">component</span>
<span class="n">hem_d</span> <span class="o">=</span> <span class="n">ccd_reader</span><span class="o">.</span><span class="n">read_pdb_cif_file</span><span class="p">(</span><span class="n">hem_d_path</span><span class="p">)</span><span class="o">.</span><span class="n">component</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">compare_molecules</span><span class="p">(</span><span class="n">hem_a</span><span class="o">.</span><span class="n">mol_no_h</span><span class="p">,</span> <span class="n">hem_d</span><span class="o">.</span><span class="n">mol_no_h</span><span class="p">)</span>
<span class="n">result</span>

</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
ParityResult(mapping={0: 0, 5: 5, 6: 6, 1: 1, 35: 42, 31: 38, 32: 39, 4: 4, 27: 37, 23: 27, 24: 28, 3: 3, 21: 26, 17: 16, 18: 17, 2: 2, 9: 9, 8: 8, 7: 7, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 10: 10, 19: 18, 20: 20, 42: 22, 44: 23, 45: 25, 22: 19, 25: 29, 26: 31, 29: 33, 30: 34, 28: 30, 33: 40, 34: 41, 37: 44, 38: 45, 39: 46, 40: 47, 41: 48, 36: 43}, similarity_score=0.6029411764705882)
</pre></div></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">ParityResult.mapping</span></code> contains left to right atom equivalency.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Similarity between heme A and heme D is: </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">similarity_score</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">.&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Similarity between heme A and heme D is: 0.603.
</pre></div></div>
</div>
</div>
<div class="section" id="Scripts">
<h2>Scripts<a class="headerlink" href="#Scripts" title="Permalink to this headline">¶</a></h2>
<p>pdbeccdutils package implements also <a class="reference external" href="https://pdbeurope.github.io/ccdutils/guide/pipelines.html">scripts</a> that we internally use for chemistry related processes in the PDBe. Directly from the package you can try out the PDBeChem that generates content of the <a class="reference external" href="http://ftp.ebi.ac.uk/pub/databases/msd/pdbechem_v2">FTP area</a> and provides all the data that are consumed by the <a class="reference external" href="http://pdbe.org/chem">service</a>.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="arpeggio.html" class="btn btn-neutral float-right" title="arpeggio" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="pdbecif.html" class="btn btn-neutral float-left" title="pdbecif" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Protein Data Bank in Europe

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>